<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Home · CropGrowth.jl</title><meta name="title" content="Home · CropGrowth.jl"/><meta property="og:title" content="Home · CropGrowth.jl"/><meta property="twitter:title" content="Home · CropGrowth.jl"/><meta name="description" content="Documentation for CropGrowth.jl."/><meta property="og:description" content="Documentation for CropGrowth.jl."/><meta property="twitter:description" content="Documentation for CropGrowth.jl."/><meta property="og:url" content="https://jeffersonfparil.github.io/CropGrowth.jl/"/><meta property="twitter:url" content="https://jeffersonfparil.github.io/CropGrowth.jl/"/><link rel="canonical" href="https://jeffersonfparil.github.io/CropGrowth.jl/"/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href>CropGrowth.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li class="is-active"><a class="tocitem" href>Home</a><ul class="internal"><li><a class="tocitem" href="#Installation"><span>Installation</span></a></li><li><a class="tocitem" href="#Examples"><span>Examples</span></a></li><li><a class="tocitem" href="#API"><span>API</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Home</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Home</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/jeffersonfparil/CropGrowth.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/jeffersonfparil/CropGrowth.jl/blob/main/docs/src/index.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="CropGrowth.jl"><a class="docs-heading-anchor" href="#CropGrowth.jl">CropGrowth.jl</a><a id="CropGrowth.jl-1"></a><a class="docs-heading-anchor-permalink" href="#CropGrowth.jl" title="Permalink"></a></h1><ul><li><a href="#CropGrowth.jl">CropGrowth.jl</a></li><li class="no-marker"><ul><li><a href="#Installation">Installation</a></li><li><a href="#Examples">Examples</a></li><li><a href="#API">API</a></li></ul></li></ul><p><a href="https://github.com/jeffersonfparil/CropGrowth.jl">CropGrowth.jl</a> is a <a href="https://julialang.org/">Julia</a> package for modelling crop growth curves using the <a href="https://en.wikipedia.org/wiki/Generalised_logistic_function">generalised logistic function</a>:</p><p class="math-container">\[y(t) = {A + {{K-A} \over {C + (Qe^{-Bt})^{1/v}}}}\]</p><p>where:</p><ul><li><span>$y(t)$</span>: biomass at time <span>$t$</span> (not part of the struct)</li><li><span>$A$</span>: lower asymptote (initial or minimum biomass)</li><li><span>$K$</span>: positively affects the upper asymptote. This be the final or maximum biomass if:<ul><li><span>$C = 1.00$</span>, since:</li><li><span>$y_{max} = A + (K-A)/C^{1/v}$</span>, then </li><li><span>$y_{max} = A + K - A$</span>, therefore: </li><li><span>$y_{max} = K$</span></li></ul></li><li><span>$C$</span>: negatively affects the final or maximum biomass</li><li><span>$Q$</span>: negatively affects initial or minimum biomass</li><li><span>$e$</span>: Euler&#39;s number (~2.71828)</li><li><span>$B$</span>: growth rate</li><li><span>$v$</span>: asymmetry parameter (<span>$v ≥ 0$</span>; small values: fast growth early; large values: fast growth later)</li></ul><p>To solve for <span>$t$</span> at specific <span>$y$</span>:</p><p class="math-container">\[t(y) = -{{1} \over {B}} \log {\left( { {{1} \over {Q}} \left( \left( {K - A} \over {y - A} \right)^v - C \right) } \right) }\]</p><h2 id="Installation"><a class="docs-heading-anchor" href="#Installation">Installation</a><a id="Installation-1"></a><a class="docs-heading-anchor-permalink" href="#Installation" title="Permalink"></a></h2><p>Please install the latest version of <a href="https://julialang.org/">Julia</a> (we aim to update <a href="https://github.com/jeffersonfparil/CropGrowth.jl">CropGrowth.jl</a> for the latest Julia release):</p><pre><code class="language-shell hljs">curl -fsSL https://install.julialang.org | sh
type -a julia</code></pre><p>Install the <a href="https://github.com/jeffersonfparil/CropGrowth.jl">CropGrowth.jl</a> library in Julia:</p><pre><code class="language-julia hljs">using Pkg
Pkg.add(&quot;https://github.com/jeffersonfparil/CropGrowth.jl&quot;)</code></pre><h2 id="Examples"><a class="docs-heading-anchor" href="#Examples">Examples</a><a id="Examples-1"></a><a class="docs-heading-anchor-permalink" href="#Examples" title="Permalink"></a></h2><p>The main API is the <code>fitgrowthmodels()</code> function:</p><pre><code class="language-julia hljs">using Pkg
Pkg.add(CropGrowth)
using CropGrowth
df = simulate()
df_out = fitgrowthmodels(df, verbose=true)</code></pre><h2 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h2><ul><li><a href="#CropGrowth.GrowthModel"><code>CropGrowth.GrowthModel</code></a></li><li><a href="#CropGrowth.fitgrowthmodels-Tuple{DataFrames.DataFrame}"><code>CropGrowth.fitgrowthmodels</code></a></li><li><a href="#CropGrowth.fitstatistics-Tuple{}"><code>CropGrowth.fitstatistics</code></a></li><li><a href="#CropGrowth.generalisedlogistic-Tuple{Vector{Float64}}"><code>CropGrowth.generalisedlogistic</code></a></li><li><a href="#CropGrowth.generalisedlogistic-Tuple{GrowthModel}"><code>CropGrowth.generalisedlogistic</code></a></li><li><a href="#CropGrowth.modelgrowth-Tuple{}"><code>CropGrowth.modelgrowth</code></a></li><li><a href="#CropGrowth.readdelimited-Tuple{}"><code>CropGrowth.readdelimited</code></a></li><li><a href="#CropGrowth.simulate-Tuple{}"><code>CropGrowth.simulate</code></a></li><li><a href="#CropGrowth.timetomaxperc-Tuple{GrowthModel}"><code>CropGrowth.timetomaxperc</code></a></li><li><a href="#CropGrowth.writedelimited-Tuple{DataFrames.DataFrame}"><code>CropGrowth.writedelimited</code></a></li></ul><article><details class="docstring" open="true"><summary id="CropGrowth.GrowthModel"><a class="docstring-binding" href="#CropGrowth.GrowthModel"><code>CropGrowth.GrowthModel</code></a> — <span class="docstring-category">Type</span></summary><section><div><pre><code class="language-julia hljs">mutable struct GrowthModel
    A::Float64
    K::Float64
    C::Float64
    Q::Float64
    B::Float64
    v::Float64
    y_t0::Float64
    y_max::Float64
    fit_statistics::Dict{String,Float64}</code></pre><p>Holds parameters for the generalized logistic growth model:</p><p class="math-container">\[y(t) = A + \frac{K-A}{C + (Qe^{-Bt})^{1/v}}\]</p><p>where:</p><ul><li><span>$y(t)$</span>: biomass at time <span>$t$</span> (not part of the struct)</li><li><span>$A$</span>: lower asymptote (initial or minimum biomass)</li><li><span>$K$</span>: positively affects the upper asymptote (can be the final or maximum biomass if <span>$C = 1.00$</span>, since <span>$y_{max} = A + (K-A)/C^(1/v)$</span>, then <span>$y_{max} = A + K - A$</span>, therefore: <span>$y_{max} = K$</span>)</li><li><span>$C$</span>: negatively affects the final or maximum biomass</li><li><span>$Q$</span>: negatively affects initial or minimum biomass</li><li><span>$e$</span>: Euler&#39;s number (~2.71828)</li><li><span>$B$</span>: growth rate</li><li><span>$v$</span>: asymmetry parameter (<span>$v ≥ 0$</span>; small values: fast growth early; large values: fast growth later)</li></ul><p>Additional information are provided in the struct:</p><ul><li><code>y_t0</code>: value of the growth model at time <span>$t = 0$</span></li><li><code>y_max</code>: maximum value of the growth model (<span>$y_{max} = A + (K-A)/C^(1/v)$</span>)</li><li><code>fit_statistics</code>: a dictionary containing fit statistics such as R², RMSE, MSE, MAE, and Pearson&#39;s correlation coefficient (ρ)</li></ul><p><strong>Constructor</strong></p><pre><code class="language-julia hljs">GrowthModel(;
    A::Float64,
    K::Float64,
    C::Float64,
    Q::Float64,
    B::Float64,
    v::Float64,
    fit_statistics::Dict{String,Float64} = Dict(&quot;&quot;=&gt;NaN),
    ϵ::Float64 = 1e-12,
)</code></pre><p><strong>Notes:</strong></p><ul><li>The struct includes a constructor that automatically calculates <code>y_max</code> based on the provided parameters.</li><li>The <code>fit_statistics</code> field is optional and defaults to a dictionary with a single entry of an empty string key and <code>NaN</code> value.</li><li>A small epsilon value (<code>ϵ</code>) is added to the calculation of <code>y_max</code> to prevent division by zero errors.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; growth_model = GrowthModel(A=0.0, K=10.0, C=1.0, Q=1.0, B=0.75, v=0.1);

julia&gt; (growth_model.y_max - growth_model.K) &lt; 1e-9
true

julia&gt; (growth_model.y_max - 10.0) &lt; 1e-9
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jeffersonfparil/CropGrowth.jl/blob/3e3e6e95457f8d2fcdcb122ce34e93518e3f95ec/src/model.jl#L1-L66">source</a></section></details></article><article><details class="docstring" open="true"><summary id="CropGrowth.fitgrowthmodels-Tuple{DataFrames.DataFrame}"><a class="docstring-binding" href="#CropGrowth.fitgrowthmodels-Tuple{DataFrames.DataFrame}"><code>CropGrowth.fitgrowthmodels</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">fitgrowthmodels(
    df::DataFrame;
    A = Dict(
        :init=&gt;minimum(select(df, Not(REQUIRED_COLUMNS))[:, 1]),
        :lower=&gt;0.0,
        :upper=&gt;maximum(select(df, Not(REQUIRED_COLUMNS))[:, 1]),
    ),
    K = Dict(
        :init=&gt;maximum(select(df, Not(REQUIRED_COLUMNS))[:, 1]),
        :lower=&gt;0.0,
        :upper=&gt;2*maximum(select(df, Not(REQUIRED_COLUMNS))[:, 1]),
    ),
    C = Dict(:init=&gt;1.0, :lower=&gt;1.0, :upper=&gt;1.0),
    Q = Dict(:init=&gt;1.0, :lower=&gt;1.0, :upper=&gt;1.0),
    B = Dict(:init=&gt;1.0, :lower=&gt;0.0, :upper=&gt;10.0),
    v = Dict(:init=&gt;1.0, :lower=&gt;1e-5, :upper=&gt;10.0),
    min_t::Int64 = 3,
    perc_of_final::Vector{Float64} = [0.5, 0.9],
    fit_statistic::String = &quot;R²&quot;,
    maxiters::Int64 = 10_000,
    seed::Int64 = 42,
    show_plots::Bool = false,
    verbose::Bool = false,
)::Tuple{DataFrame, Vector{String}}</code></pre><p>Fits generalized logistic growth models to the data provided in the input <code>DataFrame</code> and returns a <code>DataFrame</code> containing the fitted parameters, fit statistics, and time to reach specified percentages of the final value.</p><p><strong>Arguments</strong></p><ul><li><code>df::DataFrame</code>: Input data containing the required columns specified in <code>REQUIRED_COLUMNS = [&quot;entries&quot;, &quot;sites&quot;, &quot;replications&quot;, &quot;growing_periods&quot;, &quot;time_points&quot;]</code> and at least one trait column.</li><li><code>A::Dict</code>: Search space for the parameter <code>A</code> (lower asymptote). Contains <code>:init</code>, <code>:lower</code>, and <code>:upper</code> keys. Defaults to the minimum and maximum of the trait column with <code>init=minimum</code>.</li><li><code>K::Dict</code>: Search space for the parameter <code>K</code> (upper asymptote). Contains <code>:init</code>, <code>:lower</code>, and <code>:upper</code> keys. Defaults to the minimum and 2×maximum of the trait column with <code>init=maximum</code>.</li><li><code>C::Dict</code>: Search space for the parameter <code>C</code>. Contains <code>:init</code>, <code>:lower</code>, and <code>:upper</code> keys. Defaults to <code>init=1.0</code>, <code>lower=1.0</code>, <code>upper=1.0</code>.</li><li><code>Q::Dict</code>: Search space for the parameter <code>Q</code>. Contains <code>:init</code>, <code>:lower</code>, and <code>:upper</code> keys. Defaults to <code>init=1.0</code>, <code>lower=1.0</code>, <code>upper=1.0</code>.</li><li><code>B::Dict</code>: Search space for the parameter <code>B</code> (growth rate). Contains <code>:init</code>, <code>:lower</code>, and <code>:upper</code> keys. Defaults to <code>init=1.0</code>, <code>lower=0.0</code>, <code>upper=10.0</code>.</li><li><code>v::Dict</code>: Search space for the parameter <code>v</code> (asymmetry parameter). Contains <code>:init</code>, <code>:lower</code>, and <code>:upper</code> keys. Defaults to <code>init=1.0</code>, <code>lower=1e-5</code>, <code>upper=10.0</code>.</li><li><code>min_t::Int64</code>: Minimum number of time points required to fit the growth model for a specific combination of entry, site, replication, and growing period. Defaults to <code>3</code>.</li><li><code>perc_of_final::Vector{Float64}</code>: Percentages of the final value for which the time to reach these percentages will be calculated. Defaults to <code>[0.5, 0.9]</code>.</li><li><code>fit_statistic::String</code>: The fit statistic to be used for evaluating the model. Must be one of <code>[&quot;R²&quot;, &quot;RMSE&quot;, &quot;MSE&quot;, &quot;MAE&quot;, &quot;ρ&quot;]</code>. Defaults to <code>&quot;R²&quot;</code>.</li><li><code>maxiters::Int64</code>: Maximum number of iterations allowed for the optimization process. Defaults to <code>10_000</code>.</li><li><code>seed::Int64</code>: Random seed for reproducibility. Defaults to <code>42</code>.</li><li><code>show_plots::Bool</code>: Whether to show fitted growth curve plots. Defaults to <code>false</code>.</li><li><code>verbose::Bool</code>: Whether to display progress and additional information during the fitting process. Defaults to <code>false</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>Tuple{DataFrame, Vector{String}}</code>: <ul><li>The first element is a <code>DataFrame</code> containing the fitted parameters (<code>A</code>, <code>K</code>, <code>C</code>, <code>Q</code>, <code>B</code>, <code>v</code>), fit statistics, value of the growth models at <span>$t=0$</span> (<code>y_t0</code>), maximum value of the growth model (<code>y_max</code>), and time to reach specified percentages of the final value for each combination of entry, site, replication, and growing period.</li><li>The second element is a <code>Vector{String}</code> containing the combinations that were skipped due to insufficient data points.</li></ul></li></ul><p><strong>Notes</strong></p><ul><li>The input <code>DataFrame</code> must contain the required columns specified in the global variable <code>REQUIRED_COLUMNS = [&quot;entries&quot;, &quot;sites&quot;, &quot;replications&quot;, &quot;growing_periods&quot;, &quot;time_points&quot;]</code>, as well as at least one additional trait column.</li><li>If the <code>DataFrame</code> contains more than one trait column, only the first trait column will be used.</li><li>Combinations with fewer than <code>min_t</code> time points will be skipped, and a warning will be issued.</li><li>The function uses a progress bar to indicate the fitting process if <code>verbose=true</code>.</li></ul><p><strong>Details</strong></p><p>Fits a generalized logistic growth model to the data using the following equation:</p><p class="math-container">\[y(t) = A + \frac{K-A}{C + (Qe^{-Bt})^{1/v}}\]</p><p>where:</p><ul><li><span>$y(t)$</span>: biomass at time <span>$t$</span></li><li><span>$A$</span>: lower asymptote (initial or minimum biomass)</li><li><span>$K$</span>: positively affects the upper asymptote (can be the final or maximum biomass if <span>$C = 1.00$</span>, since <span>$y_{max} = A + (K-A)/C^(1/v)$</span>, then <span>$y_{max} = A + K - A$</span>, therefore: <span>$y_{max} = K$</span>)</li><li><span>$C$</span>: negatively affects the final or maximum biomass</li><li><span>$Q$</span>: negatively affects initial or minimum biomass</li><li><span>$e$</span>: Euler&#39;s number (~2.71828)</li><li><span>$B$</span>: growth rate</li><li><span>$v$</span>: asymmetry parameter (<span>$v ≥ 0$</span>; small values: fast growth early; large values: fast growth later)</li></ul><p>Additional information are provided in the output <code>DataFrame</code>:</p><ul><li><code>y_t0</code> is the value of the growth model at time <span>$t = 0$</span></li><li><code>y_max</code> is the maximum value of the growth model (<span>$y_{max} = A + (K-A)/C^(1/v)$</span>)</li><li>One of the following fit statistic such as R² (default), RMSE, MSE, MAE, and Pearson&#39;s correlation coefficient (ρ)</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; df = simulate(n_entries=5, seed=42);

julia&gt; df_out, skipped_combinations = fitgrowthmodels(df);

julia&gt; length(unique(df.entries)) == length(unique(df_out.entries))
true

julia&gt; length(unique(df.sites)) == length(unique(df_out.sites))
true

julia&gt; length(unique(df.replications)) == length(unique(df_out.replications))
true

julia&gt; length(unique(df.growing_periods)) == length(unique(df_out.growing_periods))
true

julia&gt; all(x -&gt; x ∈ names(df_out), [&quot;A&quot;, &quot;K&quot;, &quot;C&quot;, &quot;Q&quot;, &quot;B&quot;, &quot;v&quot;, &quot;y_max&quot;, &quot;R²&quot;, &quot;time_to_50p&quot;, &quot;time_to_90p&quot;])
true

julia&gt; (var(df_out.A) &gt; 0.0) &amp;&amp; (var(df_out.K) &gt; 0.0) &amp;&amp; (var(df_out.C) == 0.0) &amp;&amp; (var(df_out.Q) == 0.0) &amp;&amp; (var(df_out.B) &gt; 0.0) &amp;&amp; (var(df_out.v) &gt; 0.0)
true

julia&gt; (var(df_out.y_max) &gt; 0.0) &amp;&amp; (var(df_out.&quot;R²&quot;) &gt; 0.0) &amp;&amp; (var(df_out.time_to_50p) &gt; 0.0) &amp;&amp; (var(df_out.time_to_90p) &gt; 0.0)
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jeffersonfparil/CropGrowth.jl/blob/3e3e6e95457f8d2fcdcb122ce34e93518e3f95ec/src/fit.jl#L1-L106">source</a></section></details></article><article><details class="docstring" open="true"><summary id="CropGrowth.fitstatistics-Tuple{}"><a class="docstring-binding" href="#CropGrowth.fitstatistics-Tuple{}"><code>CropGrowth.fitstatistics</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">fitstatistics(; y::Vector{Float64}, ŷ::Vector{Float64})::Dict{String, Float64}</code></pre><p>Compute various fit statistics for a given set of observed and predicted values.</p><p><strong>Arguments</strong></p><ul><li><code>y::Vector{Float64}</code>: Observed data points.</li><li><code>ŷ::Vector{Float64}</code>: Predicted data points.</li></ul><p><strong>Returns</strong></p><p>A dictionary containing the following fit statistics:</p><ul><li><code>&quot;R²&quot;</code>: Coefficient of determination, a measure of how well the predicted values explain the variance in the observed data.</li><li><code>&quot;rmse&quot;</code>: Root mean squared error, a measure of the average magnitude of the residuals.</li><li><code>&quot;mse&quot;</code>: Mean squared error, the average of the squared residuals.</li><li><code>&quot;mae&quot;</code>: Mean absolute error, the average of the absolute residuals.</li><li><code>&quot;ρ&quot;</code>: Pearson correlation coefficient between the observed and predicted values.</li></ul><p><strong>Notes</strong></p><ul><li>Ensure that the <code>y</code> and <code>ŷ</code> vectors are of the same length and correspond to the same observations.</li><li>The function assumes that both <code>y</code> and <code>ŷ</code> are non-empty vectors.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; y1::Vector{Float64} = rand(10); y2::Vector{Float64} = rand(10);

julia&gt; stats0 = fitstatistics(y=y1, ŷ=y1);

julia&gt; stats1 = fitstatistics(y=y1, ŷ=y2);

julia&gt; stats0[&quot;R²&quot;] &gt; stats1[&quot;R²&quot;]
true

julia&gt; stats0[&quot;rmse&quot;] &lt; stats1[&quot;rmse&quot;]
true

julia&gt; stats0[&quot;mse&quot;] &lt; stats1[&quot;mse&quot;]
true

julia&gt; stats0[&quot;mae&quot;] &lt; stats1[&quot;mae&quot;]
true

julia&gt; stats0[&quot;ρ&quot;] &gt; stats1[&quot;ρ&quot;]
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jeffersonfparil/CropGrowth.jl/blob/3e3e6e95457f8d2fcdcb122ce34e93518e3f95ec/src/model.jl#L93-L137">source</a></section></details></article><article><details class="docstring" open="true"><summary id="CropGrowth.generalisedlogistic-Tuple{GrowthModel}"><a class="docstring-binding" href="#CropGrowth.generalisedlogistic-Tuple{GrowthModel}"><code>CropGrowth.generalisedlogistic</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">generalisedlogistic(growth_model::GrowthModel; t::Vector{Float64})::Vector{Float64}</code></pre><p>Computes the generalized logistic function for a given vector of time points <code>t</code> using the parameters defined in the <code>GrowthModel</code>.</p><p><strong>Arguments</strong></p><ul><li><code>growth_model::GrowthModel</code>: A struct containing the parameters for the generalized logistic function.</li><li><code>t::Vector{Float64}</code>: A vector of time points at which to evaluate the function.</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Float64}</code>: A vector of values representing the generalized logistic function evaluated at each time point in <code>t</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Float64}</code>: A vector of values representing the generalized logistic function evaluated at each time point in <code>t</code>.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; t = collect(0.0:1.0:10.0);

julia&gt; growth_model = GrowthModel(A=0.0, K=10.0, C=1.0, Q=1.0, B=0.75, v=0.1);

julia&gt; y = generalisedlogistic(growth_model, t=t);

julia&gt; (y[1] == minimum(y)) &amp;&amp; (y[end] == maximum(y))
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jeffersonfparil/CropGrowth.jl/blob/3e3e6e95457f8d2fcdcb122ce34e93518e3f95ec/src/model.jl#L194-L220">source</a></section></details></article><article><details class="docstring" open="true"><summary id="CropGrowth.generalisedlogistic-Tuple{Vector{Float64}}"><a class="docstring-binding" href="#CropGrowth.generalisedlogistic-Tuple{Vector{Float64}}"><code>CropGrowth.generalisedlogistic</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">generalisedlogistic(t::Vector{Float64}; A=0.0, K=1.0, C=1.0, Q=1.0, B=1.0, v=1.0)::Vector{Float64}</code></pre><p>Computes the generalized logistic function for a given vector of time points <code>t</code>.</p><p><strong>Arguments</strong></p><ul><li><code>t::Vector{Float64}</code>: A vector of time points at which to evaluate the function.</li></ul><p><strong>Keyword Arguments</strong></p><ul><li><code>A::Float64</code> (default: <code>0.0</code>): lower asymptote (initial or minimum biomass)</li><li><code>K::Float64</code> (default: <code>1.0</code>): upper asymptote (can be the final or maximum biomass if <span>$C = 1.00$</span>, since <span>$y_{max} = A + (K-A)/C^(1/v)$</span>, then <span>$y_{max} = A + K - A$</span>, therefore: <span>$y_{max} = K$</span>)</li><li><code>C::Float64</code> (default: <code>1.0</code>): negatively affects the final or maximum biomass</li><li><code>Q::Float64</code> (default: <code>1.0</code>): negatively affects initial or minimum biomass</li><li><code>B::Float64</code> (default: <code>1.0</code>): growth rate</li><li><code>v::Float64</code> (default: <code>1.0</code>): asymmetry parameter (<span>$v ≥ 0$</span>; small values: fast growth early; large values: fast growth later)</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Float64}</code>: A vector of values representing the generalized logistic function evaluated at each time point in <code>t</code>.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; t = collect(0.0:1.0:10.0);

julia&gt; y = generalisedlogistic(t; A=0.0, K=10.0, C=1.0, Q=1.0, B=0.75, v=0.1);

julia&gt; (y[1] == minimum(y)) &amp;&amp; (y[end] == maximum(y))
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jeffersonfparil/CropGrowth.jl/blob/3e3e6e95457f8d2fcdcb122ce34e93518e3f95ec/src/model.jl#L153-L181">source</a></section></details></article><article><details class="docstring" open="true"><summary id="CropGrowth.modelgrowth-Tuple{}"><a class="docstring-binding" href="#CropGrowth.modelgrowth-Tuple{}"><code>CropGrowth.modelgrowth</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">modelgrowth(; 
    y::Vector{Float64}, 
    t::Vector{Float64}, 
    θ_search_space::Dict{String, Dict{Symbol, Float64}}, 
    maxiters::Int64=10_000, 
    seed::Int64=42, 
    verbose::Bool=false
)::GrowthModel</code></pre><p>Fit a generalized logistic growth model to the given data <code>y</code> over time <code>t</code>.</p><p><strong>Arguments</strong></p><ul><li><code>y::Vector{Float64}</code>: The observed data points representing the growth values.</li><li><code>t::Vector{Float64}</code>: The corresponding time points for the observed data.</li><li><code>θ_search_space::Dict{String, Dict{Symbol, Float64}}</code>: A dictionary defining the search space for each parameter of the generalized logistic model. Each key corresponds to a parameter name (<code>&quot;A&quot;</code>, <code>&quot;K&quot;</code>, <code>&quot;C&quot;</code>, <code>&quot;Q&quot;</code>, <code>&quot;B&quot;</code>, <code>&quot;v&quot;</code>), and the value is another dictionary with keys <code>:init</code>, <code>:lower</code>, and <code>:upper</code> specifying the initial value, lower bound, and upper bound for that parameter.</li><li><code>maxiters::Int64=10_000</code>: The maximum number of iterations for the optimization algorithm. Defaults to 10,000.</li><li><code>seed::Int64=42</code>: The random seed for reproducibility. Defaults to 42.</li><li><code>verbose::Bool=false</code>: If <code>true</code>, prints the fitted parameters, fit statistics, and displays a plot of the fitted model. Defaults to <code>false</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>GrowthModel</code>: A structure containing the fitted parameters of the generalized logistic growth model and fit statistics.</li></ul><p><strong>Details</strong></p><ul><li>The function uses an optimization algorithm to minimize the mean squared error between the observed data <code>y</code> and the generalized logistic model. </li><li>The model parameters are constrained within bounds specified in the <code>θ_search_space</code> dictionary.</li><li>The optimization is performed using the <code>BBO_adaptive_de_rand_1_bin_radiuslimited()</code> algorithm.</li><li>The function also computes fit statistics, which are included in the returned <code>GrowthModel</code> structure.</li><li>If <code>verbose</code> is set to <code>true</code>, the function prints the fitted parameters, fit statistics, and displays a scatter plot of the observed data along with the fitted curve.</li></ul><p><strong>Notes</strong></p><ul><li><code>y_max</code> may be unexpectedly high if <code>C</code> is fitted freely which may indicate a simple linear growth rather than a logistic growth pattern.</li><li>If <code>y_max</code> is desired to be equal to <code>K</code>, set <code>C = 1.0</code> when defining the <code>θ_search_space</code>, i.e. In <code>θ_search_space</code> define <code>&quot;C&quot; =&gt; Dict(:init=&gt;1.0, :lower=&gt;1.0, :upper=&gt;1.0)</code>.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; t = collect(1.0:10.0);

julia&gt; growth_model_1 = modelgrowth(t=t, y=sort(vcat([0.0, 0.0, 1.0, 1.0], rand(6))));

julia&gt; growth_model_2 = modelgrowth(t=t, y=rand(10));

julia&gt; growth_model_1.fit_statistics[&quot;R²&quot;] &gt; growth_model_2.fit_statistics[&quot;R²&quot;]
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jeffersonfparil/CropGrowth.jl/blob/3e3e6e95457f8d2fcdcb122ce34e93518e3f95ec/src/model.jl#L233-L278">source</a></section></details></article><article><details class="docstring" open="true"><summary id="CropGrowth.readdelimited-Tuple{}"><a class="docstring-binding" href="#CropGrowth.readdelimited-Tuple{}"><code>CropGrowth.readdelimited</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">readdelimited(; fname::String, delim::Union{Char,String} = &quot;	&quot;, trait_name::String = &quot;biomass&quot;)::DataFrame</code></pre><p>Reads a delimited file into a <code>DataFrame</code> and validates its structure.</p><p><strong>Arguments</strong></p><ul><li><code>fname::String</code>: The path to the file to be read.</li><li><code>delim::Union{Char,String}</code>: The delimiter used in the file. Defaults to tab (<code>&quot;	&quot;</code>).</li><li><code>trait_name::String</code>: The name of the trait column to validate. Defaults to <code>&quot;biomass&quot;</code>.</li></ul><p><strong>Returns</strong></p><ul><li>A <code>DataFrame</code> containing the data from the file with the following required columns:<ul><li><code>entries</code></li><li><code>sites</code></li><li><code>replications</code></li><li><code>growing_periods</code></li><li><code>time_points</code></li><li>The column specified by <code>trait_name</code></li></ul></li></ul><p><strong>Throws</strong></p><ul><li><code>ArgumentError</code>: If the file does not exist.</li><li><code>ArgumentError</code>: If any of the <code>REQUIRED_COLUMNS = [&quot;entries&quot;, &quot;sites&quot;, &quot;replications&quot;, &quot;growing_periods&quot;, &quot;time_points&quot;]</code>, including <code>trait_name</code>, are missing.</li></ul><p><strong>Notes</strong></p><ul><li>The function expects the file to contain specific <code>REQUIRED_COLUMNS = [&quot;entries&quot;, &quot;sites&quot;, &quot;replications&quot;, &quot;growing_periods&quot;, &quot;time_points&quot;]</code>, defined in <code>REQUIRED_COLUMNS</code>, along with the column specified by <code>trait_name</code>.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; df = simulate();

julia&gt; CSV.write(&quot;test.tsv&quot;, df, delim=&quot;	&quot;);

julia&gt; df_read = readdelimited(fname=&quot;test.tsv&quot;, delim=&quot;	&quot;, trait_name=&quot;biomass&quot;);

julia&gt; isequal(df, df_read)
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jeffersonfparil/CropGrowth.jl/blob/3e3e6e95457f8d2fcdcb122ce34e93518e3f95ec/src/io.jl#L94-L131">source</a></section></details></article><article><details class="docstring" open="true"><summary id="CropGrowth.simulate-Tuple{}"><a class="docstring-binding" href="#CropGrowth.simulate-Tuple{}"><code>CropGrowth.simulate</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">simulate(; 
    n_entries::Int64 = 100, 
    n_sites::Int64 = 2, 
    n_replications::Int64 = 3, 
    n_growing_periods::Int64 = 4, 
    n_time_points_per_growing_period::Int64 = 10, 
    seed::Int64 = 42
)::DataFrame</code></pre><p>Simulates crop growth data and returns it as a <code>DataFrame</code>. The function generates synthetic data for multiple entries, sites, replications, growing periods, and time points, with random biomass values.</p><p><strong>Keyword Arguments</strong></p><ul><li><code>n_entries::Int64</code>: Number of crop entries to simulate (default: 100).</li><li><code>n_sites::Int64</code>: Number of sites to simulate (default: 2).</li><li><code>n_replications::Int64</code>: Number of replications per site (default: 3).</li><li><code>n_growing_periods::Int64</code>: Number of growing periods per replication (default: 4).</li><li><code>n_time_points_per_growing_period::Int64</code>: Number of time points per growing period (default: 10).</li><li><code>seed::Int64</code>: Random seed for reproducibility (default: 42).</li></ul><p><strong>Returns</strong></p><p>A <code>DataFrame</code> with the following columns:</p><ul><li><code>entries</code>: Crop entry identifiers.</li><li><code>sites</code>: Site identifiers.</li><li><code>replications</code>: Replication identifiers.</li><li><code>growing_periods</code>: Growing period identifiers.</li><li><code>time_points</code>: Time points within each growing period.</li><li><code>biomass</code>: Simulated biomass values.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; df = simulate(n_entries=5, n_sites=1, n_replications=1, n_growing_periods=1, n_time_points_per_growing_period=5, trait_name=&quot;some_trait_name&quot;, seed=123);

julia&gt; size(df)
(25, 6)

julia&gt; var(df.some_trait_name) &gt; 0.0
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jeffersonfparil/CropGrowth.jl/blob/3e3e6e95457f8d2fcdcb122ce34e93518e3f95ec/src/io.jl#L1-L40">source</a></section></details></article><article><details class="docstring" open="true"><summary id="CropGrowth.timetomaxperc-Tuple{GrowthModel}"><a class="docstring-binding" href="#CropGrowth.timetomaxperc-Tuple{GrowthModel}"><code>CropGrowth.timetomaxperc</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">timetomaxperc(growth_model::GrowthModel; p::Vector{Float64} = [0.5])::Vector{Float64}</code></pre><p>Calculate the time required for a growth model to reach a proportion <code>p</code> of its carrying capacity <code>K</code>.</p><p><strong>Arguments</strong></p><ul><li><code>growth_model::GrowthModel</code>: An instance of the <code>GrowthModel</code> type containing the parameters of the growth model.</li><li><code>p::Vector{Float64}</code>: A vector of proportions (default is <code>[0.5]</code>) representing the fraction of the carrying capacity <code>K</code> to compute the time for.</li></ul><p><strong>Returns</strong></p><ul><li><code>Vector{Float64}</code>: A vector of times corresponding to each proportion in <code>p</code>.</li></ul><p><strong>Details</strong></p><ul><li>The function computes the maximum value of the growth model (<span>$y_{max} = A + (K-A)/C^(1/v)$</span>) based on its parameters.</li><li>For each proportion in <span>$p$</span>, the corresponding value of <span>$y$</span> is calculated as <span>$p * y_{max}$</span>.</li><li>The time required to reach each <span>$y$</span> is computed using the generalised logistic growth model formula, which involves logarithmic and complex arithmetic operations.</li><li>The result is the real part of the computed times.</li><li>The formula is:</li></ul><p class="math-container">\[t = -\frac{1}{B} \cdot \ln \left( \frac{\left( \left( \frac{K - A}{y - A} \right)^v - C \right)}{Q} \right)\]</p><p><strong>Notes</strong></p><ul><li>The function assumes that the <code>GrowthModel</code> instance contains the parameters <code>A</code>, <code>K</code>, <code>C</code>, <code>Q</code>, <code>B</code>, and <code>v</code>.</li><li>The computation may involve complex numbers, but only the real part of the result is returned.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; growth_model = modelgrowth(t=collect(1.0:10.0), y=sort(vcat([0.0, 0.0, 1.0, 1.0], rand(6))));

julia&gt; p = [0.5, 0.95, 0.99];

julia&gt; time_to_Kp = timetomaxperc(growth_model; p=p);

julia&gt; ŷ = generalisedlogistic(growth_model, t=time_to_Kp);

julia&gt; all( abs.(ŷ .- (p .* growth_model.y_max)) .&lt; 1e-5 )
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jeffersonfparil/CropGrowth.jl/blob/3e3e6e95457f8d2fcdcb122ce34e93518e3f95ec/src/model.jl#L402-L441">source</a></section></details></article><article><details class="docstring" open="true"><summary id="CropGrowth.writedelimited-Tuple{DataFrames.DataFrame}"><a class="docstring-binding" href="#CropGrowth.writedelimited-Tuple{DataFrames.DataFrame}"><code>CropGrowth.writedelimited</code></a> — <span class="docstring-category">Method</span></summary><section><div><pre><code class="language-julia hljs">writedelimited(df::DataFrame; fname::String, delim::Union{Char,String} = &quot;	&quot;, overwrite::Bool = false)::Nothing</code></pre><p>Writes the contents of a <code>DataFrame</code> to a delimited text file.</p><p><strong>Arguments</strong></p><ul><li><code>df::DataFrame</code>: The data frame to be written to the file. Must contain the required columns:<ul><li><code>entries</code></li><li><code>sites</code></li><li><code>replications</code></li><li><code>growing_periods</code></li><li><code>time_points</code></li><li>1 additional column representing the trait data</li></ul></li><li><code>fname::String</code>: The name of the output file, including its path if necessary.</li><li><code>delim::Union{Char,String}</code>: The delimiter to use in the output file. Defaults to a tab character (<code>&quot;	&quot;</code>).</li><li><code>overwrite::Bool</code>: Whether to overwrite the file if it already exists. Defaults to <code>false</code>.</li></ul><p><strong>Returns</strong></p><ul><li><code>Nothing</code>: This function does not return a value.</li></ul><p><strong>Example</strong></p><pre><code class="language-julia-repl hljs">julia&gt; df = simulate();

julia&gt; fname = writedelimited(df, fname=&quot;test.tsv&quot;, delim=&quot;	&quot;, overwrite=true);

julia&gt; isfile(fname)
true

julia&gt; df_read = readdelimited(fname=&quot;test.tsv&quot;, delim=&quot;	&quot;, trait_name=&quot;biomass&quot;);

julia&gt; isequal(df, df_read)
true</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/jeffersonfparil/CropGrowth.jl/blob/3e3e6e95457f8d2fcdcb122ce34e93518e3f95ec/src/io.jl#L151-L185">source</a></section></details></article></article><nav class="docs-footer"><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Monday 1 December 2025 04:42">Monday 1 December 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
